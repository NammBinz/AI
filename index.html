<!DOCTYPE html>
<html class="dark" lang="vi">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>AutoPlate ID - Phiên Bản Hợp Nhất Hoàn Chỉnh</title>
    
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;700&family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#258cf4",
                        "background-light": "#f5f7f8",
                        "background-dark": "#101922",
                        "surface-dark": "#1b2127",
                    }
                },
            },
        }
    </script>
    
    <style>
        body { min-height: 100dvh; overflow-x: hidden; font-family: 'Noto Sans', sans-serif; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Sidebar logic */
        #sidebar-overlay { display: none; }
        #sidebar-overlay.open { display: block; }
        #sidebar { transform: translateX(-100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        #sidebar.open { transform: translateX(0); }
        
        /* Scan line animation */
        .scan-line {
            position: absolute; width: 100%; height: 2px; background: #258cf4;
            box-shadow: 0 0 15px #258cf4; animation: scanMove 2.5s linear infinite;
        }
        @keyframes scanMove { 0% { top: 0%; } 100% { top: 100%; } }

        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white antialiased">

    <div id="sidebar-overlay" class="fixed inset-0 bg-black/60 z-[60] backdrop-blur-sm" onclick="toggleSidebar()"></div>
    <div id="sidebar" class="fixed top-0 left-0 h-full w-72 bg-white dark:bg-surface-dark z-[70] shadow-2xl p-6 flex flex-col">
        <div class="flex items-center gap-3 mb-10">
            <div class="size-10 bg-primary rounded-xl flex items-center justify-center text-white"><span class="material-symbols-outlined">directions_car</span></div>
            <h2 class="text-xl font-bold font-display tracking-tight">AutoPlate ID</h2>
        </div>
        <nav class="flex-1 space-y-2">
            <button onclick="navigateTo('page-home'); toggleSidebar()" class="w-full flex items-center gap-4 p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-left">
                <span class="material-symbols-outlined text-slate-500">home</span><span class="font-bold text-sm">Trang chủ</span>
            </button>
            <button onclick="navigateTo('page-scan-image'); toggleSidebar()" class="w-full flex items-center gap-4 p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-left">
                <span class="material-symbols-outlined text-primary">image</span><span class="font-bold text-sm">Quét bằng ảnh</span>
            </button>
            <button onclick="navigateTo('page-scan-video'); toggleSidebar()" class="w-full flex items-center gap-4 p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-left">
                <span class="material-symbols-outlined text-red-500">videocam</span><span class="font-bold text-sm">Quét bằng video</span>
            </button>
            <button onclick="navigateTo('page-history'); toggleSidebar()" class="w-full flex items-center gap-4 p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-left">
                <span class="material-symbols-outlined text-blue-400">history</span><span class="font-bold text-sm">Lịch sử nhận diện</span>
            </button>
            <button onclick="navigateTo('page-reviews'); toggleSidebar()" class="w-full flex items-center gap-4 p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-left">
                <span class="material-symbols-outlined text-yellow-500">grade</span><span class="font-bold text-sm">Đánh giá khách hàng</span>
            </button>
            <div class="h-px bg-slate-200 dark:bg-slate-700 my-4"></div>
            <button onclick="navigateTo('page-settings'); toggleSidebar()" class="w-full flex items-center gap-4 p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-left">
                <span class="material-symbols-outlined text-slate-500">settings</span><span class="font-bold text-sm">Cài đặt</span>
            </button>
        </nav>
        <button onclick="navigateTo('page-login'); toggleSidebar()" class="p-3 text-red-500 font-bold text-sm flex items-center gap-4 mt-auto">
            <span class="material-symbols-outlined">logout</span> Đăng xuất
        </button>
    </div>

    <div class="relative flex min-h-screen w-full flex-col max-w-md mx-auto shadow-2xl border-x border-slate-200 dark:border-slate-800 bg-background-light dark:bg-background-dark">
        
        <div id="page-login" class="page active px-6 py-10">
            <div class="flex flex-col items-center mb-10 text-center">
                <div class="w-20 h-20 bg-primary/10 rounded-3xl flex items-center justify-center mb-4">
                    <span class="material-symbols-outlined text-primary text-4xl">document_scanner</span>
                </div>
                <h1 id="auth-title" class="text-3xl font-bold font-display">Xin chào!</h1>
                <p id="auth-desc" class="text-slate-500 text-sm mt-1">Đăng nhập để bắt đầu sử dụng</p>
            </div>

            <div class="bg-slate-100 dark:bg-slate-800 p-1 rounded-2xl flex mb-8">
                <button onclick="switchAuth(true)" id="tab-login" class="flex-1 py-2.5 rounded-xl text-sm font-bold bg-white dark:bg-surface-dark shadow text-primary">Đăng nhập</button>
                <button onclick="switchAuth(false)" id="tab-register" class="flex-1 py-2.5 rounded-xl text-sm font-bold text-slate-500">Đăng ký</button>
            </div>
            
            <div class="space-y-4">
                <div id="field-name" class="hidden">
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Họ và tên</label>
                    <input type="text" class="w-full mt-1 bg-white dark:bg-surface-dark border-slate-200 dark:border-slate-700 rounded-2xl h-14 px-5 focus:ring-primary shadow-sm" placeholder="Nguyễn Văn A">
                </div>
                <div>
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Email / SĐT</label>
                    <input type="text" id="auth-email" class="w-full mt-1 bg-white dark:bg-surface-dark border-slate-200 dark:border-slate-700 rounded-2xl h-14 px-5 focus:ring-primary shadow-sm" placeholder="user@example.com">
                </div>
                <div>
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Mật khẩu</label>
                    <input type="password" id="auth-pass" class="w-full mt-1 bg-white dark:bg-surface-dark border-slate-200 dark:border-slate-700 rounded-2xl h-14 px-5 focus:ring-primary shadow-sm" placeholder="••••••••">
                </div>
                <button type="button" onclick="manualLogin()" class="w-full bg-primary h-14 rounded-2xl font-bold text-white shadow-xl shadow-blue-500/30 mt-4 active:scale-95 transition-all">
                    Tiếp tục
                </button>
            </div>
        </div>

        <div id="page-home" class="page">
            <div class="p-4 flex justify-between items-center sticky top-0 bg-background-light dark:bg-background-dark z-10 border-b dark:border-slate-800">
                <button onclick="toggleSidebar()" class="size-10 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800 shadow-sm">
                    <span class="material-symbols-outlined">menu</span>
                </button>
                <h2 class="font-bold text-lg font-display tracking-tight">AutoPlate ID</h2>
                <button onclick="navigateTo('page-settings')" class="size-10 rounded-full bg-primary text-white flex items-center justify-center font-bold">A</button>
            </div>
            
            <div class="px-4 py-6">
                <div class="relative h-48 rounded-3xl overflow-hidden bg-surface-dark mb-8 shadow-lg">
                    <img src="https://images.unsplash.com/photo-1590362891991-f776e747a588?auto=format&fit=crop&q=80&w=500" class="w-full h-full object-cover opacity-60">
                    <div class="absolute inset-0 p-6 flex flex-col justify-end bg-gradient-to-t from-black/80 to-transparent">
                        <h3 class="text-xl font-bold text-white leading-tight">Quét Biển Số Xe AI</h3>
                        <p class="text-slate-300 text-[10px] font-bold uppercase tracking-widest">Độ chính xác 99.8%</p>
                    </div>
                </div>
                
                <h3 class="font-bold text-xs text-slate-400 uppercase tracking-widest mb-4 px-1">Dịch vụ</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div onclick="navigateTo('page-scan-image')" class="p-6 bg-white dark:bg-surface-dark rounded-3xl border border-slate-100 dark:border-slate-800 text-center cursor-pointer shadow-sm hover:border-primary transition-all">
                        <span class="material-symbols-outlined text-primary text-3xl mb-2">image</span>
                        <p class="font-bold text-sm">Quét từ Ảnh</p>
                    </div>
                    <div onclick="navigateTo('page-scan-video')" class="p-6 bg-white dark:bg-surface-dark rounded-3xl border border-slate-100 dark:border-slate-800 text-center cursor-pointer shadow-sm hover:border-red-500 transition-all">
                        <span class="material-symbols-outlined text-red-500 text-3xl mb-2">videocam</span>
                        <p class="font-bold text-sm">Trực Tiếp</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-scan-image" class="page px-4 pb-20">
            <div class="py-4 flex items-center gap-4">
                <button onclick="navigateTo('page-home')"><span class="material-symbols-outlined">arrow_back</span></button>
                <h2 class="font-bold">Nhận diện từ ảnh</h2>
            </div>
            <div class="relative w-full h-64 border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-3xl bg-slate-50 dark:bg-slate-800/20 overflow-hidden">
                <label for="img-input-file" class="absolute inset-0 flex flex-col items-center justify-center cursor-pointer z-10">
                    <div id="upload-ph" class="text-center">
                        <span class="material-symbols-outlined text-4xl text-primary mb-2">add_photo_alternate</span>
                        <p class="text-sm font-bold">Chọn ảnh từ thư viện</p>
                    </div>
                    <img id="img-pv" class="absolute inset-0 w-full h-full object-contain hidden" src="#">
                </label>
                <input id="img-input-file" type="file" accept="image/*" class="hidden" onchange="previewImgFile(this)">
            </div>
            <button onclick="alert('Đang phân tích biển số...')" class="w-full mt-6 bg-primary h-14 rounded-2xl font-bold text-white shadow-xl active:scale-95 transition-all">Phân tích</button>
        </div>

        <div id="page-history" class="page">
            <div class="p-4 sticky top-0 bg-background-light dark:bg-background-dark z-10 border-b dark:border-slate-800">
                <div class="flex items-center gap-4">
                    <button onclick="navigateTo('page-home')"><span class="material-symbols-outlined">arrow_back</span></button>
                    <h2 class="font-bold">Lịch sử nhận diện</h2>
                </div>
            </div>
            <div class="p-4 space-y-4 pb-20">
                <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Hôm nay, 24/05</p>
                <div class="flex items-center gap-4 p-4 bg-white dark:bg-surface-dark rounded-2xl border dark:border-slate-800 shadow-sm">
                    <div class="size-12 bg-slate-100 dark:bg-slate-700 rounded-lg shrink-0 overflow-hidden">
                        <img src="https://via.placeholder.com/100x50" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1">
                        <h4 class="font-bold text-sm tracking-tight">30A - 123.45</h4>
                        <p class="text-[10px] text-slate-500">14:20 • Thành công</p>
                    </div>
                    <span class="text-green-500 font-bold text-xs italic">98%</span>
                </div>
                <div class="flex items-center gap-4 p-4 bg-white dark:bg-surface-dark rounded-2xl border dark:border-slate-800 shadow-sm opacity-80">
                    <div class="size-12 bg-slate-100 dark:bg-slate-700 rounded-lg shrink-0 overflow-hidden">
                        <img src="https://via.placeholder.com/100x50" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1">
                        <h4 class="font-bold text-sm tracking-tight">51F - 888.88</h4>
                        <p class="text-[10px] text-slate-500">12:10 • Thành công</p>
                    </div>
                    <span class="text-green-500 font-bold text-xs italic">95%</span>
                </div>
            </div>
        </div>

        <div id="page-reviews" class="page px-4 pb-24">
            <div class="py-4 flex items-center gap-4">
                <button onclick="navigateTo('page-home')"><span class="material-symbols-outlined">arrow_back</span></button>
                <h2 class="font-bold text-lg">Đánh giá khách hàng</h2>
            </div>
            <div class="bg-primary/5 p-8 rounded-[40px] text-center mb-8 border border-primary/10">
                <p class="text-5xl font-black font-display tracking-tighter">4.8</p>
                <div class="flex justify-center text-yellow-500 my-2 gap-1"><span class="material-symbols-outlined fill-1">star</span><span class="material-symbols-outlined fill-1">star</span><span class="material-symbols-outlined fill-1">star</span><span class="material-symbols-outlined fill-1">star</span><span class="material-symbols-outlined">star_half</span></div>
                <p class="text-xs font-bold text-slate-500 uppercase tracking-widest">1,248 lượt đánh giá</p>
            </div>
            <div class="space-y-4">
                <div class="p-4 bg-white dark:bg-surface-dark rounded-2xl border dark:border-slate-800">
                    <p class="font-bold text-sm text-primary">Nguyễn Hoàng Nam</p>
                    <p class="text-xs text-slate-500 mt-1 italic leading-relaxed">"Nhận diện siêu nhanh, giao diện đẹp. Rất thích hợp để quản lý xe chung cư."</p>
                </div>
            </div>
        </div>

        <div id="page-scan-video" class="page px-4">
            <div class="py-4 flex items-center gap-4"><button onclick="navigateTo('page-home')"><span class="material-symbols-outlined">arrow_back</span></button><h2 class="font-bold">Quét trực tiếp</h2></div>
            <div class="aspect-video bg-black rounded-3xl relative overflow-hidden"><div class="scan-line"></div></div>
        </div>
        <div id="page-settings" class="page px-4 pt-6">
             <h2 class="font-bold text-xl mb-8">Cài đặt</h2>
             <button onclick="navigateTo('page-login')" class="w-full p-4 bg-red-500/10 text-red-500 font-bold rounded-2xl flex items-center justify-center gap-2">
                <span class="material-symbols-outlined">logout</span> Đăng xuất
            </button>
        </div>

        <div id="bottom-nav" class="fixed bottom-0 left-0 right-0 mx-auto max-w-md bg-white/95 dark:bg-background-dark/95 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 flex justify-around items-center h-16 z-50 rounded-t-3xl shadow-2xl">
            <button onclick="navigateTo('page-home')" class="nav-btn-icon flex flex-col items-center text-primary" data-pg="page-home"><span class="material-symbols-outlined">home</span><span class="text-[10px] font-bold">Chính</span></button>
            <button onclick="navigateTo('page-history')" class="nav-btn-icon flex flex-col items-center text-slate-400" data-pg="page-history"><span class="material-symbols-outlined">history</span><span class="text-[10px] font-bold">Lịch sử</span></button>
            <div class="relative -top-5"><button onclick="navigateTo('page-scan-video')" class="size-14 bg-primary rounded-full text-white shadow-xl flex items-center justify-center border-4 border-background-light dark:border-background-dark active:scale-90 transition-transform"><span class="material-symbols-outlined text-3xl">qr_code_scanner</span></button></div>
            <button onclick="navigateTo('page-scan-image')" class="nav-btn-icon flex flex-col items-center text-slate-400" data-pg="page-scan-image"><span class="material-symbols-outlined">image</span><span class="text-[10px] font-bold">Ảnh</span></button>
            <button onclick="navigateTo('page-settings')" class="nav-btn-icon flex flex-col items-center text-slate-400" data-pg="page-settings"><span class="material-symbols-outlined">settings</span><span class="text-[10px] font-bold">Cài đặt</span></button>
        </div>
    </div>

    <script>
        // FIX LỖI ĐĂNG NHẬP: Bỏ qua hành vi Form mặc định
        function manualLogin() {
            const email = document.getElementById('auth-email').value;
            const pass = document.getElementById('auth-pass').value;

            if (email.trim() !== "" && pass.trim() !== "") {
                navigateTo('page-home');
            } else {
                alert("Vui lòng nhập đủ Email và Mật khẩu!");
            }
        }

        // ĐIỀU HƯỚNG TRANG (SPA)
        function navigateTo(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            // Hiện bottom nav trừ trang login
            document.getElementById('bottom-nav').style.display = (pageId === 'page-login') ? 'none' : 'flex';
            
            // Cập nhật màu nút nav
            document.querySelectorAll('.nav-btn-icon').forEach(btn => {
                if(btn.dataset.pg === pageId) btn.classList.replace('text-slate-400', 'text-primary');
                else btn.classList.replace('text-primary', 'text-slate-400');
            });

            window.scrollTo(0, 0);
        }

        function switchAuth(isLogin) {
            document.getElementById('field-name').style.display = isLogin ? 'none' : 'block';
            document.getElementById('auth-title').innerText = isLogin ? "Xin chào!" : "Tạo tài khoản";
            document.getElementById('btn-auth').innerText = isLogin ? "Đăng nhập" : "Đăng ký ngay";
            
            const tabL = document.getElementById('tab-login');
            const tabR = document.getElementById('tab-register');
            if(isLogin) {
                tabL.className = "flex-1 py-2.5 rounded-xl text-sm font-bold bg-white dark:bg-surface-dark shadow text-primary transition-all";
                tabR.className = "flex-1 py-2.5 rounded-xl text-sm font-bold text-slate-500 transition-all";
            } else {
                tabR.className = "flex-1 py-2.5 rounded-xl text-sm font-bold bg-white dark:bg-surface-dark shadow text-primary transition-all";
                tabL.className = "flex-1 py-2.5 rounded-xl text-sm font-bold text-slate-500 transition-all";
            }
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('sidebar-overlay').classList.toggle('open');
        }

        function previewImgFile(input) {
            const preview = document.getElementById('img-pv');
            const placeholder = document.getElementById('upload-ph');
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    preview.src = e.target.result;
                    preview.classList.remove('hidden');
                    placeholder.classList.add('hidden');
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Khởi động tại màn hình Login
        navigateTo('page-login');
    </script>
</body>
</html>